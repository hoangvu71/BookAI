.PHONY: dev install test lint format clean docker-build docker-run

# Development
dev:
	@echo "ğŸš€ Starting development server..."
	poetry run uvicorn bookai_adk.main:app --reload --host 0.0.0.0 --port 8000

install:
	@echo "ğŸ“¦ Installing dependencies..."
	poetry install

# Testing
test:
	@echo "ğŸ§ª Running tests..."
	poetry run pytest -v

test-watch:
	@echo "ğŸ‘€ Running tests in watch mode..."
	poetry run pytest-watch

# Code Quality
lint:
	@echo "ğŸ” Linting code..."
	poetry run ruff check .
	poetry run mypy src/

format:
	@echo "âœ¨ Formatting code..."
	poetry run black .
	poetry run isort .

# ADK specific
adk-doctor:
	@echo "ğŸ©º Running ADK doctor..."
	poetry run python -c "import google.generativeai as genai; print('âœ… Google ADK dependencies OK')"

# Docker
docker-build:
	@echo "ğŸ³ Building Docker image..."
	docker build -t bookai-adk-service .

docker-run:
	@echo "ğŸ³ Running Docker container..."
	docker run -p 8000:8000 --env-file .env bookai-adk-service

# Cleanup
clean:
	@echo "ğŸ§¹ Cleaning up..."
	find . -type d -name "__pycache__" -exec rm -rf {} +
	find . -type f -name "*.pyc" -delete
	rm -rf .pytest_cache .mypy_cache .ruff_cache